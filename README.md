# Описание
Данный проект позволяет сгенерировать синтетические ТЭМ-изображения синтеза металлорганических каркасов, 
разметить их и использовать для обучения модели обнаружения объектов. Текущий вариант реализации позволяет
генерировать изображения с помощью Blender Python API для обнаружения октаэдрической геометрической формы. 
Также размещены размеченная и неразмеченная выборка сгенерированных данных, веса и файл конфигурации обученной
модели YOLO v5. Инструкции приведены ниже.
# Генерация данных
- Запустите Generator.blend, предварительно установив актуальную версию **Blender**
[![Blender Download](https://img.shields.io/badge/Blender-3.1.2-brightgreen)](https://www.blender.org/download/)
- Вкладка _Scripts_ -> скрипт _CreateScene_
- Установите удобные вам параметры в скрипте согласно комментариям (По умолчанию генерируются 90-160 объектов и
 производится 1 рендер)
- **Обращаем ваше внимание, что генерация происходит в главном потоке по умолчанию в режиме CPU, при рендере
 вы не сможете пользоваться Blender**
 <details>
  <summary>Новый проект Blender</summary>
 
  Если вы хотите запустить скрипты в другом проекте:
  - Предварительно выполните скрипт _SceneOption_
  - Настройте альфа-каналы созданных материалов через вкладку _Shading_
  - При необходимости добавте интересующий вас фон на камеру и в настройки рендера
</details>


# Разметка данных
Вы можете использовать наши размеченные данные, их будет достаточно для пробного обучения моделей
Так же вы можете использовать любое ПО для создания _Anchor Boxes_, например 
[![LabelIMG](https://img.shields.io/badge/tzutalin-labelIMG-brightgreen)](https://github.com/tzutalin/labelImg).
Так же вы можете воспользоваться авторазметкой от авторов (скрипт _AnchorOcto_, по умолчанию создает файлы меток для Yolo).
Если вы планируете размечать данные вручную, советуем вам использовать наш проект .blend и создавать октаэдрические формы
в красном цвете. Тогда вы сможете отметить на рендерах объекты даже с учетом перекрытия, а далее перевести всю тренировочную
выборку в ч/б формат.


# Использование модели
Для тестирующих обнаружений вы можете использовать наши веса для Yolo v5.
1. Скачайте актуальный репозиторий Yolo v5
[![Yolo](https://img.shields.io/badge/ultralytics-yolov5-brightgreen)](https://github.com/ultralytics/yolov5)
2. Добавьте наши веса last.pt в _yolov5->runs->train->exp->weights_ (если таких нет, то создайте) и используйте 
   этот код (Для collab/notebook), либо в строке кода измените путь к весам
```python
                               #your path to weights                                                 path to img
!python detect.py --weights .../yolov5/runs/train/exp/weights/last.pt --img 224 --conf 0.25 --source ../58.png 
```
3. Следуйте по указанному пути к обработанному изображению (обычно это _yolov5->runs->detect->exp{num your exp}->yourfile.png_)
